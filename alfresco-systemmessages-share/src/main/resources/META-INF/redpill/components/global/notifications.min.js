'use strict';(function(){function m(){new f}var e=YAHOO.util.Dom,g=YAHOO.util.Event,k=YAHOO.util.Cookie,l=YAHOO.Bubbling,f=function(){Alfresco.util.Ajax.jsonGet({url:"/share/proxy/alfresco/api/redpill/notifications?active=true",successCallback:{fn:function(b){if(b.json&&b.json.notifications)g.onDOMReady(function(){this._callback(b.json.notifications)}.bind(this))}.bind(this)}})};f.prototype._callback=function(b){for(var c=0;c<b.length;c++){var a=b[c];this._readCookie(a.id)||("High"!==a.type&&(a.close=
function(h){this.setRemovalCookie(h.id,a)}.bind(this)),l.fire("notifications.notify",a))}};f.prototype._readCookie=function(b){return k.get("deletednotifications"+b)};f.prototype.setRemovalCookie=function(b,c){this._readCookie(b);var a=new Date;a.setTime(a.getTime()+864E5);c.endTime&&(a=new Date(c.endTime));k.set("deletednotifications"+b,"read",{expires:a})};var d;l.on("notifications.notify",function(b,c){d=d||e.get("notifications");d||(d=document.createElement("div"),d.id="notifications",b=e.get("HEADER_LICENSE_WARNING"),
null!=b?e.insertAfter(d,b):Don.insertBefore(d,"bd"));var a=c[1];a={id:a.id?a.id:"",title:a.title?a.title:"",text:a.text?a.text:"",type:a.type?a.type:"normal",close:a.close};c=document.createElement("div");c.innerHTML='<div id="{id}" class="notification {type}">{close}<span class="title">{title}</span>{text}</div>'.replace("{id}",a.id).replace("{type}",a.type.toLowerCase()).replace("{title}",a.title).replace("{text}",a.text).replace("{close}",a.close?'<a href="#" class="close"></a>':"");a.node=e.getFirstChild(c);
d.appendChild(a.node);a.close&&e.getElementsByClassName("close","a",a.node,function(h){g.on(h,"click",function(n){g.stopPropagation(n);Alfresco.util.Anim.fadeOut(a.node);YAHOO.lang.isFunction(a.close)&&a.close(a)})})});if("guest"!==Alfresco.constants.USERNAME.toLowerCase())YAHOO.util.Event.onContentReady("HEADER_LICENSE_WARNING",m,this)})();
